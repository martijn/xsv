# Xsv Changelog

## HEAD

- Fix issue #56 with multiple nil headers 
- Ignore colums with a `nil` header in hash mode

## 1.3.0 2023-12-16

- Ruby 2.6 is no longer supported. Xsv is compatible with Ruby 2.7 through 3.3, latest JRuby, and latest TruffleRuby
- Easier access worksheets using `Xsv::Workbook#[]` and `Enumerable` methods on `Xsv::Workbook`. The old `sheets` and `sheet_by_name` method have been retained for backward compatibility.
- Update of development dependencies including minitest and standardrb
- Various performance improvements, especially with YJIT on Ruby 3.3

## 1.2.1 2023-05-09

- Handle columns without `r` attribute (issue #48)
- Access sheets by UTF-8 name (thanks @sebikeller)

## 1.2.0 2023-01-01

**This release contains the following minor breaking changes**

- Raise an error when entering hash mode on a sheet with duplicate headers to prevent unintentional behaviour (fixes #44)
- Xsv now returns frozen strings to further improve performance. This means it's no longer possible to call mutating methods on strings read from worksheets without unfreezing them first.
- Unescape all HTML entities in XML characters (thanks @til)

## 1.1.1 2022-04-01

- Improve compatibility with files generated by the Open XML SDK (#40)

## 1.1.0 2022-02-13

- New, shorter `Xsv.open` syntax as a drop-in replacement for `Xsv::Workbook.open`, which is still supported
- Enable parsing of headers for all sheets by passing `parse_headers: true` to `Xsv.open`
- Improvements in performance and test coverage
- Dropped support for Ruby 2.5, which is EOL. Xsv 1.1.0 supports Ruby 2.6+, latest JRuby, latest TruffleRuby

## 1.0.6 2022-01-07

- Code cleanup, small performance improvements

## 1.0.5 2022-01-05

- Raise exception if given an empty buffer when opening workbook (thanks @kevin-j-m)

## 1.0.4 2021-07-05

- Support for custom date/time columns

## 1.0.3 2021-05-06

- Handle nil number formats correctly (regression in Xsv 1.0.2, #29)

## 1.0.2 2021-05-01

- Ignore phonetic shared string data (thanks @sinoue-1003)
- Throw ArgumentError when `Workbook.new` is called unintentionally

## 1.0.1 2021-03-18

- Allow passing a block to Workbook.open
- `parse_headers!` returns self to allow chaining (thanks @senhalil)

## 1.0.0 2021-01-26

- Xsv no longer depends on native extensions, thanks to a pure-Ruby XML parser

## 1.0.0.pre.2 2021-01-22

- Reduce allocations in XML parser
- Return strings with the correct encoding
- Handle XML entities

## 1.0.0.pre 2021-01-18

-  Switch to a minimalistic XML parser in native Ruby (#21)
-  Ruby 3.0 compatibility
-  Various internal cleanup and optimization
-  API is backwards compatible with 0.3.x

## 0.3.18 2020-09-30

-  Improve inline string support (#18)

## 0.3.17 2020-07-03

- Fix parsing of empty worksheets (#17)

## 0.3.16 2020-06-03

- Support complex numbers (#16)

## 0.3.15 2020-06-02

- Fix issue with workbooks that don't contain shared strings (#15)

## 0.3.14 2020-05-22

- Allow opening workbooks from Tempfile and anything that responds to #read

- Preserve whitespace in text cells

## 0.3.13 2020-05-12

- Add Sheet#hidden?

- Clean up code; get rid of some deprecation warnings

## 0.3.12 - 2020-04-15

- Accessing worksheets by name (texpert)

## 0.3.11 - 2020-04-03

- Backward compatibility with Ruby 2.5 (texpert)

## 0.3.10 - 2020-03-19

- Relax version requirements for dependencies

## 0.3.9 - 2020-03-16

- Fix an edge case issue with row_skip  and empty rows

## 0.3.8 - 2020-03-11

- Improve compatibility with files exported from LibreOffice

- Support for boolean type

## 0.3.7 - 2020-03-05

Reduce retained memory, making Xsv the definite performance king among the
Ruby Excel parsing gems.

## 0.3.6 - 2020-03-05

Reduce memory usage

## 0.3.5 - 2020-03-02

Fix a Gemfile small Gemfile issue that broke the 0.3.3 and 0.3.4 releases

## 0.3.3 - 2020-03-02

Initial version with a changelog and reasonably complete YARD documentation.
